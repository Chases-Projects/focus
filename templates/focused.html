<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daily Focus Sheet</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <script src="{{ url_for('static', filename='theme-init.js') }}"></script>
  
</head>
<body>
  <h1>🗓️ Daily Focus Sheet</h1>

  {% for label, key, items in [('Top 3 Priorities', 'top3', top3), ('To-Do Queue', 'todo', todo), ('Distraction Log', 'distractions', distractions)] %}
    <h2>{{ label }}</h2>
    <button onclick="toggleCompleted(this)">Show Completed</button>
    <ul id="{{ key }}-list">
      {% for item in items %}
        {% set is_editing = editing_id == item.id %}
        <li class="task-row drag-handle {% if item.completed %}completed-item hidden{% endif %}" data-id="{{ item.id }}">
          <form method="POST">
            <input type="hidden" name="section" value="complete">
            <input type="hidden" name="task_id" value="{{ item.id }}">
            <input type="checkbox" onChange="this.form.submit()" {% if item.completed %}checked{% endif %}>
          </form>

          {% if is_editing %}
            <form method="POST">
              <input name="item" value="{{ item.content }}">
              <input type="hidden" name="section" value="edit">
              <input type="hidden" name="task_id" value="{{ item.id }}">
              <button type="submit">💾</button>
            </form>
          {% else %}
            <span class="{% if item.completed %}completed{% endif %}">{{ item.content }}</span>
            <form method="POST">
              <input type="hidden" name="task_id" value="{{ item.id }}">
              <input type="hidden" name="section" value="delete">
              <button type="submit">🗑️</button>
            </form>
            <form method="GET">
              <input type="hidden" name="edit_id" value="{{ item.id }}">
              <button type="submit">✏️</button>
            </form>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    <form method="POST">
      <input name="item" placeholder="Add new item">
      <input type="hidden" name="section" value="{{ key }}">
      <button type="submit">Add</button>
    </form>
  {% endfor %}

  <!-- Text box for taking notes -->
  <h2>🧠 Quick Notes</h2>
  <form method="POST">
    <textarea name="item" rows="5">{{ note.content if note else '' }}</textarea>
    <input type="hidden" name="section" value="notes">
    <button type="submit">Save</button>
  </form>

  <!-- Javascript Src -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="{{ url_for('static', filename='sortable.js') }}"></script>
  <script src="{{ url_for('static', filename='toggle.js') }}"></script>
  <script src="{{ url_for('static', filename='darkmode.js') }}"></script>

</body>
</html>
